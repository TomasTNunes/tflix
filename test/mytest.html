<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TFLIX</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      display: flex;
      flex-direction: column;
      background: linear-gradient(135deg, #141414 0%, #0c0c0c 100%);
      color: #fff;
      min-height: 100vh;
      padding: 20px;
      position: relative;
      overflow-x: hidden;
      min-width: 360px;
    }

    body::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background:
        radial-gradient(circle at 20% 30%, rgba(229, 9, 20, 0.08) 0%, transparent 40%),
        radial-gradient(circle at 80% 70%, rgba(229, 9, 20, 0.08) 0%, transparent 40%),
        repeating-linear-gradient(45deg, rgba(20, 20, 20, 0.1) 0px, rgba(20, 20, 20, 0.1) 1px, transparent 1px, transparent 11px),
        repeating-linear-gradient(135deg, rgba(20, 20, 20, 0.1) 0px, rgba(20, 20, 20, 0.1) 1px, transparent 1px, transparent 11px);
      z-index: -1;
    }

    .main-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Server Selector */
    .server-selector {
      align-self: flex-end;
      transition: all 0.6s ease;
    }

    .dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-select {
      background: #222;
      color: white;
      padding: 10px 20px;
      border-radius: 30px;
      cursor: pointer;
      display: flex;
      align-items: center;
      font-weight: 600;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }

    .dropdown-select:hover {
      background: #e50914;
    }

    .dropdown-select i {
      margin-left: 10px;
      transition: transform 0.3s ease;
    }

    .dropdown.active .dropdown-select i {
      transform: rotate(180deg);
    }

    .dropdown-options {
      position: absolute;
      right: 0;
      background: #222;
      border-radius: 10px;
      width: 100%;
      margin-top: 10px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      z-index: 100;
    }

    .dropdown.active .dropdown-options {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .dropdown-option {
      padding: 12px 20px;
      cursor: pointer;
      transition: background 0.3s ease;
      border-radius: 5px;
    }

    .dropdown-option:hover {
      background: #e50914;
      color: white;
      font-weight: 600;
    }

    .dropdown-option:first-child {
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
    }
        
    .dropdown-option:last-child {
      border-bottom-left-radius: 10px;
      border-bottom-right-radius: 10px;
    }

    /* Header and Title */
    header {
      margin-bottom: 40px;
      position: relative;
    }

    .title {
      font-size: 5rem;
      font-weight: 800;
      color: #e50914;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      letter-spacing: 2px;
      margin-top: 20px;
      position: relative;
      display: inline-block;
    }

    .title::after {
      content: "";
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 50%;
      height: 4px;
      background: #e50914;
      border-radius: 3px;
    }

    /* Selector Container */
    .selector-container {
      margin-bottom: 40px;
      min-width: 297.1px;
    }

    .selector {
      background: #222;
      border-radius: 50px;
      padding: 6px;
      display: flex;
      position: relative;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .option {
      padding: 12px 40px;
      cursor: pointer;
      z-index: 2;
      font-weight: 600;
      font-size: 1.1rem;
      border-radius: 50px;
      transition: color 0.3s ease;
    }

    .option.selected {
      color: white;
      font-weight: 800;
    }

    .option:not(.selected) {
      color: #888;
    }

    .slider {
      position: absolute;
      height: calc(100% - 12px);
      width: calc(50% - 6px);
      background: #e50914;
      border-radius: 50px;
      transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      box-shadow: 0 2px 8px rgba(229, 9, 20, 0.4);
    }

    /* Search Bar */
    .search-container {
      margin-bottom: 50px;
      max-width: 600px;
      width: 100%;
      min-width: 70px;
    }

    .search-bar {
      display: flex;
      align-items: center;
      background: #222;
      border-radius: 50px;
      padding: 12px 25px;
      width: 100%;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      overflow: hidden;
    }

    .search-bar:focus-within {
      box-shadow: 0 4px 20px rgba(229, 9, 20, 0.3);
      transform: translateY(-2px);
    }

    .search-bar input {
      flex: 1;
      min-width: 0;
      border: none;
      background: transparent;
      color: white;
      font-size: 1.1rem;
      padding: 8px 15px;
      outline: none;
    }

    .search-icon {
      color: #e50914;
      font-size: 1.5rem;
      margin-right: 10px;
    }

    /* Content Placeholder */
    .content {
      text-align: center;
      opacity: 0.7;
    }

    .content i {
      font-size: 5rem;
      color: #e50914;
      margin-bottom: 20px;
    }

    .content p {
      margin-bottom: 40px;
    }

    .results-container {
      display: none;
    }

    /* --- FOCUS STATE (when typing) --- */
    .search-focused .main-container {
      flex-direction: row;
      justify-content: space-between;
      align-items: center; 
      margin-bottom: 40px;
      gap: 20px;
    }

    .search-focused header,
    .search-focused .content {
      display: none;
    }

    .search-focused .server-selector {
      align-self: flex-start;
      order: 1;
    }

    .search-focused .search-container {
      margin-bottom: 0;
    }

    .search-focused .selector-container {
      margin-bottom: 0;
    }

    /* Results Container */
    .search-focused .results-container {
      display: block;
      flex: 1;
    }

    /* Result Cards */
    .result-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
    }

    .result-card {
      background: #222;
      border-radius: 10px;
      overflow: hidden;
      transition: transform 0.3s ease;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      cursor: pointer;
    }

    .result-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(229, 9, 20, 0.3);
    }

    .card-image {
      height: 150px;
      background: #333;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #888;
    }

    .card-content {
      padding: 15px;
    }

    .card-content h3 {
      margin-bottom: 10px;
      color: #fff;
    }

    .card-content p {
      color: #aaa;
      font-size: 0.9rem;
    }
    

  </style>
</head>
<body>
    <!-- Main Container -->
  <div class="main-container">

    <!-- Server Selector (Top Right) -->
    <div class="server-selector">
      <div class="dropdown">
        <div class="dropdown-select" onclick="toggleDropdown()">
          <span>Rakan</span>
          <i class="fas fa-chevron-down"></i>
        </div>
        <div class="dropdown-options">
          <div class="dropdown-option" onclick="selectServer('Rakan',1)">Rakan</div>
          <div class="dropdown-option" onclick="selectServer('Bard',2)">Bard</div>
          <div class="dropdown-option" onclick="selectServer('Xayah',3)">Xayah</div>
          <div class="dropdown-option" onclick="selectServer('Ekko',4)">Ekko</div>
          <div class="dropdown-option" onclick="selectServer('Naafiri',5)">Naafiri</div>
          <div class="dropdown-option" onclick="selectServer('Ryze',6)">Ryze</div>
        </div>
      </div>
    </div>

    <!-- Title (Top Center) -->
    <header>
      <h1 class="title">TFLIX</h1>
    </header>

    <!-- Selector (Movie/TV Show) -->
    <div class="selector-container">
      <div class="selector">
        <div class="slider"></div>
        <div class="option selected" onclick="selectOption('movie')">Movie</div>
        <div class="option" onclick="selectOption('tv')">TV Show</div>
      </div>
    </div>

    <!-- Search Bar -->
    <div class="search-container">
      <div class="search-bar">
        <i class="fas fa-search search-icon"></i>
        <input type="text" placeholder="Search for movies, TV shows, and more...">
      </div>
    </div>

    <!-- Content Placeholder -->
    <div class="content">
      <i class="fas fa-film"></i>
      <p>Select a category and start searching to see results</p>
      <i class="fas fa-server"></i>
      <p>Select a category and start searching to see results</p>
    </div>

  </div>

  <!-- Result Container -->
  <div class="results-container">

    <!-- Result Cards -->
    <div class="result-cards">

      <!-- Result Card -->
      <!-- <div class="result-card">
          <div class="card-image">
            <i class="fas fa-film" style="font-size: 2rem;"></i>
          </div>
          <div class="card-content">
            <h3>Sample Movie</h3>
            <p>Action, Adventure • 2023</p>
          </div>
      </div> -->

  </div>

  <script>

    const API_BASE = "https://api.themoviedb.org/3/search";
    const headers = {
      'Authorization': `Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIwYTk1NzRmZDcxMjRkNmI5ZTUyNjA4ZWEzNWQ2NzdiNCIsIm5iZiI6MTczNzU5MDQ2NC4zMjUsInN1YiI6IjY3OTE4NmMwZThiNjdmZjgzM2ZhNjM4OCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.kWqK74FSN41PZO7_ENZelydTtX0u2g6dCkAW0vFs4jU`,
      'accept': 'application/json'
    };

    let currentType = "movie";
    let currentServer = 1;
    let prevValue = '';

    const searchInput = document.querySelector('.search-bar input');
    const resultsContainer = document.querySelector(".result-cards");

    // Dropdown functionality
    function toggleDropdown() {
      document.querySelector('.dropdown').classList.toggle('active');
    }

    function selectServer(server, id) {
      document.querySelector('.dropdown-select span').textContent = server;
      document.querySelector('.dropdown').classList.remove('active');
      currentServer = id;
    }

    document.addEventListener('click', function (event) {
      const dropdown = document.querySelector('.dropdown');
      if (!dropdown.contains(event.target)) {
        dropdown.classList.remove('active');
      }
    });

    // Selector functionality
    function selectOption(type) {
      const options = document.querySelectorAll('.option');
      const slider = document.querySelector('.slider');

      options.forEach(option => option.classList.remove('selected'));

      if (type === 'movie') {
        options[0].classList.add('selected');
        slider.style.transform = 'translateX(0)';
      } else {
        options[1].classList.add('selected');
        slider.style.transform = 'translateX(100%)';
      }

      currentType = type;

      // Run search again if there’s a query
      if (searchInput.value.trim() !== '') {
        searchTMDB(searchInput.value.trim());
      }
    }

    // Layout animation
    const container = document.querySelector(".main-container");
    function animateLayoutChange(addClass) {
      const children = Array.from(container.children);
      const firstRects = children.map(el => el.getBoundingClientRect());

      if (addClass) {
        document.body.classList.add('search-focused');
      } else {
        document.body.classList.remove('search-focused');
      }

      const lastRects = children.map(el => el.getBoundingClientRect());

      children.forEach((el, i) => {
        const dx = firstRects[i].left - lastRects[i].left;
        const dy = firstRects[i].top - lastRects[i].top;
        el.style.transform = `translate(${dx}px, ${dy}px)`;
      });

      requestAnimationFrame(() => {
        children.forEach(el => {
          el.style.transition = "transform 0.6s ease";
          el.style.transform = "translate(0,0)";
        });
      });

      setTimeout(() => {
        children.forEach(el => {
          el.style.transition = "";
        });
      }, 600);
    }

    // Search input
    searchInput.addEventListener('input', () => {
      const currentValue = searchInput.value.trim();
      if (prevValue === '' && currentValue !== '') {
        animateLayoutChange(true);
      }
      if (prevValue !== '' && currentValue === '') {
        animateLayoutChange(false);
        resultsContainer.innerHTML = "";
      }
      if (currentValue !== '') {
        searchTMDB(currentValue);
      }
      prevValue = currentValue;
    });

    // Search TMDB API
    async function searchTMDB(query) {
      try {
        const res = await fetch(`${API_BASE}/${currentType}?query=${encodeURIComponent(query)}`, {
          method: 'GET',
          headers: headers
        });
        const data = await res.json();
        displayResults(data.results || []);
      } catch (err) {
        console.error("TMDB Fetch Error:", err);
      }
    }

    // Display results
    function displayResults(results) {
      resultsContainer.innerHTML = "";
      if (results.length === 0) {
        resultsContainer.innerHTML = "<p>No results found.</p>";
        return;
      }

      results.forEach(item => {
        const title = currentType === "movie" ? item.title : item.name;
        const year = (currentType === "movie" ? item.release_date : item.first_air_date) || "";
        const poster = item.poster_path 
          ? `https://image.tmdb.org/t/p/w500${item.poster_path}`
          : null;

        const card = document.createElement("div");
        card.className = "result-card";
        card.onclick = () => {
          window.open(`https://tmdbplayer.nunesnetwork.com/?type=${currentType}&id=${item.id}&server=${currentServer}`, "_blank");
        };

        card.innerHTML = `
          <div class="card-image" style="${poster ? `background-image: url('${poster}'); background-size: cover; background-position: center;` : ""}">
            ${!poster ? `<i class="fas fa-film" style="font-size: 2rem;"></i>` : ""}
          </div>
          <div class="card-content">
            <h3>${title}</h3>
            <p>${year ? year.split("-")[0] : "Unknown Year"}</p>
          </div>
        `;
        resultsContainer.appendChild(card);
      });
    }

  </script>
</body>
</html>
